global
    log 127.0.0.1 local0
    log 127.0.0.1 local1 notice
    chroot /usr/local/sbin
    maxconn 4096
    daemon
    nbproc 4
    pidfile /usr/local/sbin/haproxy.pid

defaults
    log 127.0.0.1 local3
    mode http
    option    httplog
    option dontlognull
    option redispatch
    retries 2
    maxconn 2000
    balance roundrobin
    timeout connect 5000ms
    timeout client 5000ms
    timeout server 5000ms
    stats enable
    stats uri /stats

frontend main
    bind 0.0.0.0:6301
    default_backend webserver

backend webserver
    {{range gets "/app/servers/*"}}
    server {{base .Key}} {{.Value}} check inter 2000 rise 2 fall 5
    {{end}}
